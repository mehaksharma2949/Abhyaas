# Vite Plugin Devv Tagger

ä¸º React ç»„ä»¶è‡ªåŠ¨æ·»åŠ è°ƒè¯•æ ‡è®°çš„ Vite æ’ä»¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ·ï¸ è‡ªåŠ¨ä¸º JSX å…ƒç´ æ·»åŠ è°ƒè¯•æ ‡è®°å±æ€§
- ğŸ¯ ç²¾ç¡®å®šä½ç»„ä»¶æºç ä½ç½®ï¼ˆæ–‡ä»¶è·¯å¾„ã€è¡Œå·ã€åˆ—å·ï¼‰
- ğŸš€ é›¶é…ç½®å¼€ç®±å³ç”¨
- ğŸ¨ æ”¯æŒ TypeScript å’Œ JSX
- ğŸ”§ å¯é…ç½®çš„æ ‡è®°é€‰é¡¹
- ğŸ—ï¸ ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨ç¦ç”¨
- ğŸ“Š æ„å»ºç»Ÿè®¡ä¿¡æ¯è¾“å‡º
- ğŸ­ æ™ºèƒ½æ’é™¤ Fragment å’Œ Three.js ç»„ä»¶

## å®‰è£…

```bash
npm install vite-plugin-devv-tagger --save-dev
# æˆ–
yarn add vite-plugin-devv-tagger -D
# æˆ–
pnpm add vite-plugin-devv-tagger -D
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ç”¨æ³•

åœ¨ `vite.config.ts` ä¸­é…ç½®ï¼š

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import componentTagger from 'vite-plugin-devv-tagger';

export default defineConfig({
  plugins: [
    componentTagger(),  // æ·»åŠ åœ¨ react æ’ä»¶ä¹‹å‰
    react(),
  ],
});
```

### é«˜çº§é…ç½®

```typescript
import componentTagger from 'vite-plugin-devv-tagger';

export default defineConfig({
  plugins: [
    componentTagger({
      // æ˜¯å¦å¯ç”¨æ’ä»¶
      enabled: true,
      
      // æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨
      enableInProduction: false,
      
      // è¦æ’é™¤çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼
      exclude: ['node_modules', 'tests'],
      
      // è¦å¤„ç†çš„æ–‡ä»¶æ‰©å±•å
      extensions: ['.jsx', '.tsx'],
      
      // æ•°æ®å±æ€§å‰ç¼€
      prefix: 'data-devv',
      
      // æ˜¯å¦æ·»åŠ ä¼ ç»Ÿå±æ€§ï¼ˆå…¼å®¹æ—§ç‰ˆæœ¬ï¼‰
      includeLegacyAttributes: true,
    }),
    react(),
  ],
});
```

## æ•ˆæœç¤ºä¾‹

### è¾“å…¥ä»£ç 

```jsx
function App() {
  return (
    <div className="container">
      <h1>Hello World</h1>
      <button onClick={handleClick}>
        Click me
      </button>
    </div>
  );
}
```

### è¾“å‡ºä»£ç ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

```jsx
function App() {
  return (
    <div data-devv-id="src/App.tsx:3:4" data-devv-name="div" className="container">
      <h1 data-devv-id="src/App.tsx:4:6" data-devv-name="h1">Hello World</h1>
      <button data-devv-id="src/App.tsx:5:6" data-devv-name="button" onClick={handleClick}>
        Click me
      </button>
    </div>
  );
}
```

## ç¯å¢ƒå˜é‡æ§åˆ¶

é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ’ä»¶è¡Œä¸ºï¼š

```bash
# å¼€å‘ç¯å¢ƒï¼ˆæ·»åŠ æ ‡è®°ï¼‰
npm run dev

# ç”Ÿäº§æ„å»ºï¼ˆä¸æ·»åŠ æ ‡è®°ï¼‰
IS_PROD=true npm run build

# å¼€å‘ç¯å¢ƒä¹Ÿä¸æ·»åŠ æ ‡è®°
IS_PROD=true npm run dev
```

## é…ç½®é€‰é¡¹

| é€‰é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `enabled` | `boolean` | `true` | æ˜¯å¦å¯ç”¨æ’ä»¶ |
| `enableInProduction` | `boolean` | `false` | æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨ |
| `exclude` | `string[]` | `['node_modules']` | è¦æ’é™¤çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ |
| `extensions` | `string[]` | `['.jsx', '.tsx']` | è¦å¤„ç†çš„æ–‡ä»¶æ‰©å±•å |
| `prefix` | `string` | `'data-devv'` | æ•°æ®å±æ€§å‰ç¼€ |
| `includeLegacyAttributes` | `boolean` | `true` | æ˜¯å¦æ·»åŠ ä¼ ç»Ÿå±æ€§ |

## æ’é™¤çš„å…ƒç´ 

æ’ä»¶ä¼šè‡ªåŠ¨æ’é™¤ä»¥ä¸‹å…ƒç´ ï¼š

- React Fragment
- Three.js/React Three Fiber ç»„ä»¶
- @react-three/drei å¯¼å…¥çš„ç»„ä»¶

## æ„å»ºç»Ÿè®¡

æ„å»ºå®Œæˆåä¼šè¾“å‡ºç»Ÿè®¡ä¿¡æ¯ï¼š

```
[devv-tagger] æ„å»ºç»Ÿè®¡:
  - æ€»æ–‡ä»¶æ•°: 45
  - å¤„ç†æ–‡ä»¶æ•°: 32
  - æ ‡è®°å…ƒç´ æ•°: 256
```

## å¼€å‘æç¤º

1. æ’ä»¶åœ¨ `enforce: "pre"` æ¨¡å¼ä¸‹è¿è¡Œï¼Œç¡®ä¿åœ¨å…¶ä»–æ’ä»¶ä¹‹å‰å¤„ç†ä»£ç 
2. ä½¿ç”¨ AST è§£æç¡®ä¿å‡†ç¡®è¯†åˆ« JSX ç»“æ„
3. è‡ªåŠ¨ç”Ÿæˆ Source Map æ”¯æŒè°ƒè¯•
4. æ ‡è®°ä¿¡æ¯åŒ…å«æ–‡ä»¶è·¯å¾„ã€è¡Œå·ã€åˆ—å·ï¼Œæ–¹ä¾¿ç²¾ç¡®å®šä½

## License

MIT